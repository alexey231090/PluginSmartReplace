# Smart Replace Plugin для Godot

## Описание
Плагин Smart Replace для Godot позволяет автоматически редактировать GDScript файлы через INI команды. Плагин интегрируется в редактор Godot и предоставляет удобный интерфейс для быстрого редактирования кода.

## Возможности

### AI Чат
- **Встроенный чат с DeepSeek** - общайтесь с AI прямо в Godot
- **Автоматическое редактирование** - AI автоматически применяет изменения к коду
- **История чата** - сохраняется контекст разговора
- **Скрытые команды** - INI команды выполняются автоматически без показа пользователю

### Работа с функциями
- **Добавление функций** - создание новых функций с комментариями
- **Замена функций** - полная замена кода и комментариев функций
- **Удаление функций** - удаление функций вместе с комментариями

### Работа с кодом вне функций
- **Добавление кода** - вставка кода в различные позиции файла
- **Удаление строк** - удаление по номерам строк (отдельные, диапазоны, комбинированные)

### Позиционирование кода
- В конец файла
- В начало файла
- После extends
- Перед extends
- На конкретную строку

## Интерфейс

### Вкладка INI
Основной интерфейс для работы с ИИ. Позволяет вводить INI команды для автоматического редактирования кода.

### Вкладка AI Чат
Интерфейс для общения с DeepSeek:
- Поле для ввода сообщений
- История чата с форматированием
- Автоматическая отправка на DeepSeek API
- Автоматическое выполнение команд из ответов
- Настройки API ключа

### Вкладка Ручная работа
Интерфейс для ручного редактирования:
- Добавление/замена/удаление функций
- Добавление кода вне функций
- Удаление строк по номерам

## Формат команд

### Структура INI команды
```
=[command]=
[action]
name=значение
code=значение
=[end]=
```

### Маркеры кода
- `<cod>` - начало блока кода
- `<end_cod>` - конец блока кода

Код между этими маркерами сохраняет отступы:
```
<cod>
func example():
    if condition:
        do_something()
    else:
        do_else()
<end_cod>
```

## Доступные действия

### 1. add_function
Добавление новой функции с комментарием.

### 2. replace_function  
Замена существующей функции.

### 3. delete_function
Удаление функции по имени.

### 4. add_code
Добавление кода вне функций.

### 5. delete_code
Удаление строк по номерам.

## Особенности

### Автоматическая нормализация отступов
- Все отступы автоматически конвертируются в 4 пробела
- Поддержка смешанных отступов (табуляция + пробелы)
- Автоматическое исправление неправильных отступов

### Предварительный просмотр
- Показ изменений перед применением
- Диф-подобный интерфейс с + и - маркерами
- Возможность отмены изменений

### Пакетная обработка
- Выполнение нескольких команд за раз
- Поддержка сложных операций редактирования

## Установка

1. Скопируйте папку `addons/smart_replace` в проект
2. Включите плагин в настройках проекта
3. Используйте кнопку "Smart Replace" в редакторе

## Использование

### С AI чатом (рекомендуется)
1. Откройте файл в редакторе
2. Нажмите "Smart Replace"
3. Перейдите на вкладку "AI Чат"
4. Настройте API ключ DeepSeek (если нужно)
5. Введите сообщение и нажмите "Отправить"
6. AI ответит и автоматически применит изменения к коду

### С ИИ
1. Откройте файл в редакторе
2. Нажмите "Smart Replace"
3. Перейдите на вкладку INI
4. Вставьте команды от ИИ
5. Нажмите "Выполнить INI"

### Ручное редактирование
1. Откройте файл в редакторе
2. Нажмите "Smart Replace"
3. Перейдите на вкладку "Ручная работа"
4. Заполните поля и нажмите "Применить"

## Ограничения

- Работает только с открытыми файлами в редакторе
- GDScript не поддерживает перегрузку функций
- Комментарии удаляются вместе с функциями
- Все отступы нормализуются в 4 пробела

## Поддержка

Плагин автоматически:
- Проверяет синтаксис команд
- Нормализует отступы
- Показывает предварительный просмотр
- Обрабатывает ошибки 